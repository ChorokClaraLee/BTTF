<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
"http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="Member">

	<select id="login" parameterType="hashmap" resultType="_int">
		SELECT COUNT(*) FROM USER_ALL WHERE user_id = #{user_id} AND user_pw = #{user_pw} AND USER_AVAILABLE = 1
	</select>
	
	<insert id="join" parameterType="userdto">
		INSERT INTO USER_ALL (user_id, user_pw, user_name, user_phone, user_email, main_language) VALUES ( #{user_id }, #{user_pw }, #{user_name }, #{user_phone }, #{user_email }, #{main_language } )
	</insert>
	
	<select id ="findPw" parameterType = "hashmap" resultType="string"	>
		SELECT user_pw FROM USER_ALL WHERE user_id = #{user_id} AND user_email = #{user_email}
	</select>
	
	<select id ="findId" parameterType = "hashmap" resultType="string"	>
		SELECT USER_ID FROM USER_ALL WHERE user_name = #{user_name} AND user_email = #{user_email}
	</select>
	
	<select id="searchById" parameterType="string" resultType="_int">
		SELECT count(*) FROM USER_ALL WHERE user_id = #{user_id}
	</select>
	
	<select id="getMemberDetail" parameterType="string" resultType="userdto">
		select * from USER_ALL WHERE user_id = #{user_id}
	</select>
	
	<update id="memberJoinEdit" parameterType="hashmap">
		update user_all set
		user_pw = #{user_pw}, user_phone = #{user_phone}, user_email = #{user_email}, main_language = #{main_language}
	</update>
	
	<update id="memberJoinOut" parameterType="userdto">
		UPDATE USER_ALL SET user_available = 0 where USER_ID = #{user_id}
	</update>
	
	<select id="bookmarkList" parameterType="string" resultType="bookmarkdto">
		SELECT c.post_subject , c.post_id, c.POST_REC, c.WRITER , c.POST_REGDATE  FROM post_bookmark pb INNER JOIN CSS c ON pb.post_id = c.POST_ID WHERE c.WRITER = #{user_id}
	</select>
	
	<insert id="getBookmarkAdd" parameterType="hashmap">
		INSERT INTO POST_BOOKMARK values (seq_bookmark.nextval, #{user_id}, #{post_id}, 0)
	</insert>
	
	<delete id="bookmarkDelete" parameterType="string">
		DELETE FROM post_bookmark WHERE POST_ID = #{post_id}
	</delete>
</mapper>
